<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=GB2312" />
</head>
<script lang="javascrit">
var wslocation;
var websocket;
var host;


	function getHost(){
		var url = window.location.href;
		var first = url.indexOf("//");
		var last = url.indexOf("/",first+2);
		var host = url.substring(first+2,last)
		return host;
	}
	
	host = getHost();
	
	function wsopen() {
		wslocation = "ws://"+host+"/websocket";
		websocket = new WebSocket(wslocation);
		websocket.onopen = function(evt) {
			onOpen(evt)
			websocket.send('connection hello');
		};
		websocket.onclose = function(evt) {
			onClose(evt)
		};
		websocket.onmessage = function(evt) {
			onMessage(evt)
		};
		websocket.onerror = function(evt) {
			onError(evt)
		};
		
		function onOpen(evt) {
			alert("连接成功.");
		}
		function onClose(evt) {
			alert("断开连接");
		}
		function onMessage(evt) {
			alert("收到消息: " + evt.data);
		}
		function onError(evt) {
			alert('连接失败: ' + evt);
		}
	}
	
	function wssend(){
		websocket.send('send hello again');
	}
	
	function wsclose(){
		websocket.close();
	}
	
	function mySubmit(type){
		var name = document.getElementById('name').value;
		var age = document.getElementById('age').value;
		
		if(type!="normal/get"){
			var testFrom = document.getElementById('testForm');
			testFrom.enctype = type;
			testForm.submit()
		}else if(type=="normal/get"){
			window.location="http://"+host+"/?name="+name+"&age="+age;
		}
		else if(type=="path/get"){
			window.location="http://"+host+"/"+name+"/"+age;
		}
	}
	
</script>
<body>
	<!-- enctype="multipart/form-data" -->
	<form id="testForm" action="/" method="post">
		<div>中文测试展示测试,用于测试编码</div>
		<div>
			name:<input id="name" name="name" type="text" value="中文测试" />
		</div>
		<div>
			age:<input id="age" name="age" type="text">
		</div>
		GET方法测试:
		<input type="button" value="normal-get" onClick="mySubmit('normal/get')">
		<input type="button" value="path-get" onClick="mySubmit('normal/get')">
		<br>
		POST方法测试:
		<input type="button" value="submit-urlencoded" onClick="mySubmit('application/x-www-form-urlencoded')">
		<input type="button" value="submit-multipart" onClick="mySubmit('multipart/form-data')">
		<br>
		WEBSOCKET测试:
		<input type="button" onclick="wsopen()" value="open">
		<input type="button" onclick="wssend()" value="send">
		<input type="button" onclick="wsclose()" value="close">
		
	</form>
</body>
</html>